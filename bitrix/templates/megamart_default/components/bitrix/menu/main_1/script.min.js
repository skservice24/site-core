window.RS||(window.RS={}),RS.MainMenu=function(){var e=function(e){this.$el=$("#"+e),this.menuHeight=this.$el.outerHeight();var t=this.$el.find(".has-children");if(setTimeout(BX.proxy(this.resizeMenu,this),100),$(document).ready(BX.proxy(this.resizeMenu,this)),$(window).on("resize",BX.debounce(BX.proxy(this.resizeMenu,this),300)),$("html").hasClass("bx-no-touch"))t.on({mouseenter:this.reveal,mouseleave:this.conceal});else{var i=this;t.on({click:function(e){$(this).data("is-open")||e.preventDefault(),$(this).data("is-open",!0)},touchstart:function(e){var t=this;if(!$(t).data("is-open")){i.reveal.call(t,[e]);var n=BX.debounce(function(e){$(e.target).is(t)||$(e.target).closest(t).length||($(t).data("is-open",!1),i.conceal.call(t,[e]),$("html").off("click touchstart",n))},100);$("html").on("click touchstart",n)}}})}this.$el.addClass("is-ready")};return e.prototype.resizeMenu=function(){var e,t,i=this.$el.children(),n=i.filter(".is-more"),s=this.$el.outerWidth(),o=0;for(this.$el.css({overflow:"hidden","max-height":this.menuHeight,opacity:"0"}),i.show(),n.insertAfter(i.filter(":last")),i=this.$el.children(),e=n.width(),i.filter(":not(.is-more)").each(function(e,t){var n=$(t).width();return o+n>s?(i.filter(":gt("+(e-1)+")").hide(),!1):(o+=n,!0)});;){if(!(o+e>s)){i.length-1>i.filter(":visible").length?(t=i.filter(":hidden:not(.is-more)").clone().show(),n.insertAfter(i.filter(":visible:last")),t.removeClass("mmenu-type1-item--primary mmenu-type1-item--dark mmenu-type1-item--transparent mmenu-type1-item--inheader has-children").addClass("mmenu-type1-item--dd-item").find(".mmenu-type1-item__dropdown").remove(),n.find(".mmenu-type1-item__dropdown").html(t),n.show()):(n.hide(),n.find(".mmenu-type1-item__dropdown").html(""));break}var r=i.filter(":visible:last");o-=r.width(),r.hide()}this.$el.css({overflow:"visible","max-height":"none",opacity:"1",visibility:"visible"})},e.prototype.reveal=function(){var e=$(this),t=e.children(".mmenu-type1-item__dropdown, .mmenu-type1-item__wide"),i=e.closest(".js-menu-container"),n=i.width();i.find(".l-mmenu-vertical").length&&(n-=i.find(".l-mmenu-vertical").width()),t.hasClass("mmenu-type1-item__wide")&&t.css("width",i.width()),t.show(),e.position().left+t.outerWidth()>n&&t.css("left",n-e.position().left-t.outerWidth()),e.position().left+2*t.outerWidth()>i.width()&&t.addClass("is-invert"),e.hasClass("mmenu-type1-item--dd-item")?t.velocity("stop").velocity("transition.fadeIn",{duration:250,delay:0}):t.velocity("stop").velocity("transition.slideUpIn",{duration:300,delay:0})},e.prototype.conceal=function(){var e=$(this).children(".mmenu-type1-item__dropdown, .mmenu-type1-item__wide");e.velocity("stop").velocity("transition.fadeOut",{duration:100,delay:0,complete:function(){e.removeClass("is-invert"),e.css("left","")}})},e}();