!function(t){"use strict";if(!t.JCCatalogElementPreview){var i=function(t){i.superclass.constructor.apply(this,arguments),this.buttonNode=BX.create("SPAN",{props:{className:"btn btn-default btn-buy btn-sm",id:this.id},style:"object"==typeof t.style?t.style:{},text:t.text,events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.extend(i,BX.PopupWindowButton),t.JCCatalogElementPreview=function(t){if(this.productType=0,this.config={useCatalog:!0,showQuantity:!0,showPrice:!0,showAbsent:!0,showOldPrice:!1,showPercent:!1,showSkuProps:!1,showOfferGroup:!1,useCompare:!1,useStickers:!1,useSubscribe:!1,useOfferName:!1,usePopup:!1,useMagnifier:!1,usePriceRanges:!1,basketAction:["BUY"],showClosePopup:!1,templateTheme:"",showSlider:!1,sliderInterval:5e3,useEnhancedEcommerce:!1,dataLayerName:"dataLayer",brandProperty:!1,alt:"",title:"",magnifierZoomPercent:200,buy1ClickUrl:"",productRequestUrl:"",useFavorite:!1,showMultiPrice:!1,useLazyImages:!0},this.checkQuantity=!1,this.maxQuantity=0,this.minQuantity=0,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.isGift=!1,this.canSubscription=!0,this.currentIsSet=!1,this.updateViewedCount=!1,this.currentPriceMode="",this.currentPrices=[],this.currentPriceSelected=0,this.currentQuantityRanges=[],this.currentQuantityRangeSelected=0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.visual={},this.basketMode="",this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,startQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:"",slider:{},sliderCount:0,useSlider:!1,sliderPict:[],measure:""},this.mess={},this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""},this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""},this.defaultPict={preview:null,detail:null},this.offers=[],this.offerNum=0,this.treeProps=[],this.selectedValues={},this.mouseTimer=null,this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch"),this.touch=null,this.slider={interval:null,progress:null,paused:null,controls:[]},this.quantityDelay=null,this.quantityTimer=null,this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obPrice={bonus:null,price:null,full:null,discount:null,percent:null,total:null},this.obTree=null,this.obPriceRanges=null,this.obBuyBtn=null,this.obAddToBasketBtn=null,this.obBasketActions=null,this.obFavorite=null,this.obProductRequestBtn=null,this.obBuy1clickBtn=null,this.obNotAvail=null,this.obSubscribe=null,this.obSkuProps=null,this.obDescription=null,this.obMainSkuProps=null,this.obBigSlider=null,this.obMeasure=null,this.obQuantityLimit={all:null,value:null},this.obCompare=null,this.obTabsPanel=null,this.node={},this.smallCardNodes={},this.magnify={enabled:!1,obBigImg:null,obBigSlider:null,height:0,width:0,timer:0},this.currentImg={id:0,src:"",width:0,height:0},this.viewedCounter={path:"/bitrix/components/bitrix/catalog.element/ajax.php",params:{AJAX:"Y",SITE_ID:"",PRODUCT_ID:0,PARENT_ID:0}},this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.errorCode=0,"object"==typeof t){switch(this.params=t,this.initConfig(),this.params.MESS&&(this.mess=this.params.MESS),this.productType){case 0:case 1:case 2:this.initProductData();break;case 3:this.initOffersData();break;default:this.errorCode=-1}this.initBasketData(),this.initCompareData(),this.isFacebookConversionCustomizeProductEventEnabled=this.params.IS_FACEBOOK_CONVERSION_CUSTOMIZE_PRODUCT_EVENT_ENABLED}0===this.errorCode&&BX.ready(BX.delegate(this.init,this)),this.params={},BX.addCustomEvent("onSaleProductIsGift",BX.delegate(this.onSaleProductIsGift,this)),BX.addCustomEvent("onSaleProductIsNotGift",BX.delegate(this.onSaleProductIsNotGift,this))},t.JCCatalogElementPreview.prototype={getEntity:function(t,i,s){return t&&i?(s=s||"",t.querySelector(s+'[data-entity="'+i+'"]')):null},getEntities:function(t,i,s){return t&&i?(s=s||"",t.querySelectorAll(s+'[data-entity="'+i+'"]')):{length:0}},onSaleProductIsGift:function(t,i){i&&this.offers&&this.offers[this.offerNum].ID==i&&this.setGift()},onSaleProductIsNotGift:function(t,i){i&&this.offers&&this.offers[this.offerNum].ID==i&&(this.restoreSticker(),this.isGift=!1,this.setPrice())},reloadGiftInfo:function(){3===this.productType&&(this.checkQuantity=!0,this.maxQuantity=1,this.setPrice(),this.redrawSticker({text:BX.message("PRODUCT_GIFT_LABEL")}))},setGift:function(){3===this.productType&&(this.isGift=!0),1!==this.productType&&2!==this.productType||(this.isGift=!0),0===this.productType&&(this.isGift=!1),this.reloadGiftInfo()},setOffer:function(t){this.offerNum=parseInt(t),this.setCurrent()},init:function(){var t=0,i=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obBigSlider=BX(this.visual.BIG_SLIDER_ID),this.node.imageContainer=this.getEntity(this.obProduct,"images-container"),this.obBigSlider&&this.node.imageContainer&&this.node.imageContainer||(this.errorCode=-2),this.config.showPrice&&(this.obPrice.price=BX(this.visual.PRICE_ID),this.obPrice.total=BX(this.visual.PRICE_TOTAL),this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID),this.obBasketActions&&(BX.util.in_array("BUY",this.config.basketAction)&&(this.obBuyBtn=BX(this.visual.BUY_LINK)),BX.util.in_array("ADD",this.config.basketAction)&&(this.obAddToBasketBtn=BX(this.visual.ADD_BASKET_LINK))),this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS)),this.config.showQuantity&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.node.quantity=this.getEntity(this.obProduct,"quantity-block"),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID))),3===this.productType&&(this.visual.TREE_ID&&(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256)),this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE)),this.visual.QUANTITY_LIMIT&&"N"!==this.config.showMaxQuantity&&(this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT),this.obQuantityLimit.all&&(this.obQuantityLimit.value=this.getEntity(this.obQuantityLimit.all,"quantity-limit-value"),this.obQuantityLimit.value||(this.obQuantityLimit.all=null))),this.config.usePriceRanges&&(this.obPriceRanges=this.getEntity(this.obProduct,"price-ranges-block"))),this.config.showSkuProps&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV),this.obMainSkuProps=BX(this.visual.DISPLAY_MAIN_PROP_DIV)),"Y"===this.config.showSkuDescription&&(this.obDescription=BX(this.visual.DESCRIPTION_ID)),this.config.useCompare&&(this.obCompare=BX(this.visual.COMPARE_LINK)),this.config.useSubscribe&&(this.obSubscribe=BX(this.visual.SUBSCRIBE_LINK)),this.config.useOfferName&&(this.obName=BX(this.visual.NAME)),this.config.useFavorite&&(this.obFavorite=BX(this.visual.FAVORITE_LINK)),this.visual.BUY1CLICK_LINK&&(this.obBuy1clickBtn=BX(this.visual.BUY1CLICK_LINK)),this.visual.ACTION_REQUEST_LINK&&(this.obProductRequestBtn=BX(this.visual.ACTION_REQUEST_LINK)),this.obSaleBanner=BX(this.visual.SALE_BANNER),this.obSaleBanner&&(BX.addCustomEvent("onTimerStart",BX.delegate(this.showSaleBanner,this)),BX.addCustomEvent("onTimerEnd",BX.delegate(this.hideSaleBanner,this))),this.config.fillAllPrices&&(this.obPricesAll=BX(this.visual.PRICES_CONTAINER)),0===this.errorCode){if(this.isTouchDevice&&(BX.bind(this.node.imageContainer,"touchstart",BX.proxy(this.touchStartEvent,this)),BX.bind(this.node.imageContainer,"touchend",BX.proxy(this.touchEndEvent,this)),BX.bind(this.node.imageContainer,"touchcancel",BX.proxy(this.touchEndEvent,this))),this.config.showQuantity){var s=this.isTouchDevice?"touchstart":"mousedown",e=this.isTouchDevice?"touchend":"mouseup";this.obQuantityUp&&(BX.bind(this.obQuantityUp,s,BX.proxy(this.startQuantityInterval,this)),BX.bind(this.obQuantityUp,e,BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))),this.obQuantityDown&&(BX.bind(this.obQuantityDown,s,BX.proxy(this.startQuantityInterval,this)),BX.bind(this.obQuantityDown,e,BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this))}switch(this.productType){case 0:case 1:case 2:this.product.useSlider&&(this.product.slider={ID:this.visual.SLIDER_CONT_ID,CONT:BX(this.visual.SLIDER_CONT_ID),COUNT:this.product.sliderCount},this.product.slider.ITEMS=this.getEntities(this.product.slider.CONT,"slider-control"),this.product.slider.ITEMS.length>1&&this.initSlider()),this.checkQuantityControls(),this.setAnalyticsDataLayer("showDetail"),this.obSaleBanner&&this.product.TIMER&&this.setTimer(this.product.TIMER);break;case 3:for(i=this.obTree.querySelectorAll("li"),t=0;t<i.length;t++)BX.bind(i[t],"click",BX.delegate(this.selectOfferProp,this));this.product.slider={ID:this.visual.SLIDER_CONT_ID,CONT:BX(this.visual.SLIDER_CONT_ID),COUNT:this.product.sliderCount},this.setCurrent()}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this)),this.obAddToBasketBtn&&BX.bind(this.obAddToBasketBtn,"click",BX.proxy(this.add2Basket,this)),this.obBasketActions&&(BX.addCustomEvent("add2basket.rs_lightbasket",function(){this.setCartStatus()}.bind(this)),BX.addCustomEvent("clear.rs_lightbasket",function(){this.setCartStatus()}.bind(this)),BX.addCustomEvent("delete.rs_lightbasket",function(){this.setCartStatus()}.bind(this)),BX.addCustomEvent("OnBasketChange",function(){this.setCartStatus()}.bind(this))),this.obCompare&&(BX.bind(this.obCompare,"click",BX.proxy(this.compare,this)),BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this)),BX.addCustomEvent("onCompareChange",BX.proxy(this.checkCompare,this))),this.obFavorite&&(BX.bind(this.obFavorite,"click",BX.proxy(this.favorite,this)),BX.addCustomEvent("change.rs_favorite",BX.proxy(this.checkFavorite,this)),this.checkFavorite()),this.setCartStatus(),this.obBuy1clickBtn&&BX.bind(this.obBuy1clickBtn,"click",BX.proxy(this.buy1Click,this))}},initConfig:function(){this.params.PRODUCT_TYPE&&(this.productType=parseInt(this.params.PRODUCT_TYPE,10)),"undefined"!==this.params.CONFIG.USE_CATALOG&&BX.type.isBoolean(this.params.CONFIG.USE_CATALOG)&&(this.config.useCatalog=this.params.CONFIG.USE_CATALOG),this.config.showQuantity=this.params.CONFIG.SHOW_QUANTITY,this.config.showPrice=this.params.CONFIG.SHOW_PRICE,this.config.showPercent=this.params.CONFIG.SHOW_DISCOUNT_PERCENT,this.config.showOldPrice=this.params.CONFIG.SHOW_OLD_PRICE,this.config.showSkuProps=this.params.CONFIG.SHOW_SKU_PROPS,this.config.showOfferGroup=this.params.CONFIG.OFFER_GROUP,this.config.useCompare=this.params.CONFIG.DISPLAY_COMPARE,this.config.useStickers=this.params.CONFIG.USE_STICKERS,this.config.useSubscribe=this.params.CONFIG.USE_SUBSCRIBE,this.config.useOfferName=this.params.CONFIG.USE_OFFER_NAME,this.config.showMaxQuantity=this.params.CONFIG.SHOW_MAX_QUANTITY,this.config.relativeQuantityFactor=parseInt(this.params.CONFIG.RELATIVE_QUANTITY_FACTOR),this.config.usePriceRanges=this.params.CONFIG.USE_PRICE_COUNT,this.config.showSkuDescription=this.params.CONFIG.SHOW_SKU_DESCRIPTION,this.config.displayPreviewTextMode=this.params.CONFIG.DISPLAY_PREVIEW_TEXT_MODE,this.config.useFavorite=this.params.CONFIG.USE_FAVORITE&&void 0!==RS.Favorite,this.sliderSlideCount=parseInt(this.params.CONFIG.SLIDER_SLIDE_COUNT,10),this.config.fillAllPrices=this.params.CONFIG.FILL_ITEM_ALL_PRICES,this.config.useLazyImages=this.params.CONFIG.USE_LAZY_IMAGES,this.params.CONFIG.MAIN_PICTURE_MODE&&(this.config.usePopup=BX.util.in_array("POPUP",this.params.CONFIG.MAIN_PICTURE_MODE),this.config.useMagnifier=BX.util.in_array("MAGNIFIER",this.params.CONFIG.MAIN_PICTURE_MODE)),this.params.CONFIG.ADD_TO_BASKET_ACTION&&(this.config.basketAction=this.params.CONFIG.ADD_TO_BASKET_ACTION),this.config.showClosePopup=this.params.CONFIG.SHOW_CLOSE_POPUP,this.config.templateTheme=this.params.CONFIG.TEMPLATE_THEME||"",this.config.showSlider="Y"===this.params.CONFIG.SHOW_SLIDER,this.config.useEnhancedEcommerce="Y"===this.params.CONFIG.USE_ENHANCED_ECOMMERCE,this.config.dataLayerName=this.params.CONFIG.DATA_LAYER_NAME,this.config.brandProperty=this.params.CONFIG.BRAND_PROPERTY,this.config.alt=this.params.CONFIG.ALT||"",this.config.title=this.params.CONFIG.TITLE||"",this.config.magnifierZoomPercent=parseInt(this.params.CONFIG.MAGNIFIER_ZOOM_PERCENT)||200,this.params.VISUAL&&"object"==typeof this.params.VISUAL&&this.params.VISUAL.ID?(this.visual=this.params.VISUAL,this.mess=this.params.MESS,this.params.CONFIG.LINK_BUY1CLICK&&(this.config.buy1ClickUrl=this.params.CONFIG.LINK_BUY1CLICK),this.params.CONFIG.LINK_BTN_REQUEST&&(this.config.productRequestUrl=this.params.CONFIG.LINK_BTN_REQUEST)):this.errorCode=-1},initProductData:function(){var t=0;if(this.params.PRODUCT&&"object"==typeof this.params.PRODUCT){if(this.config.showPrice&&(this.currentPriceMode=this.params.PRODUCT.ITEM_PRICE_MODE,this.currentPrices=this.params.PRODUCT.ITEM_PRICES,this.currentAllPrices=this.params.PRODUCT.ITEM_ALL_PRICES,this.currentPriceSelected=this.params.PRODUCT.ITEM_PRICE_SELECTED,this.currentQuantityRanges=this.params.PRODUCT.ITEM_QUANTITY_RANGES,this.currentQuantityRangeSelected=this.params.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED),this.config.showQuantity&&(this.product.checkQuantity=this.params.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=this.params.PRODUCT.QUANTITY_FLOAT,this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.MAX_QUANTITY):parseInt(this.params.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.STEP_QUANTITY):parseInt(this.params.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.stepQuantity=this.product.stepQuantity,this.maxQuantity=this.product.maxQuantity,this.minQuantity="Q"===this.currentPriceMode?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor)),this.product.canBuy=this.params.PRODUCT.CAN_BUY,this.canSubscription=this.product.canSubscription=this.params.PRODUCT.SUBSCRIPTION,this.product.name=this.params.PRODUCT.NAME,this.product.pict=this.params.PRODUCT.PICT,this.product.id=this.params.PRODUCT.ID,this.product.category=this.params.PRODUCT.CATEGORY,this.params.PRODUCT.ADD_URL&&(this.product.addUrl=this.params.PRODUCT.ADD_URL),this.params.PRODUCT.BUY_URL&&(this.product.buyUrl=this.params.PRODUCT.BUY_URL),this.params.PRODUCT.SLIDER_COUNT&&(this.product.sliderCount=parseInt(this.params.PRODUCT.SLIDER_COUNT,10)||0,this.product.sliderCount>0&&this.params.PRODUCT.SLIDER.length))for(t=0;t<this.params.PRODUCT.SLIDER.length;t++)this.product.useSlider=!0;this.params.PRODUCT.TIMER&&(this.product.TIMER=this.params.PRODUCT.TIMER),this.currentIsSet=!0}else this.errorCode=-1},initOffersData:function(){this.params.OFFERS&&BX.type.isArray(this.params.OFFERS)?(this.offers=this.params.OFFERS,this.offerNum=0,this.params.OFFER_SELECTED&&(this.offerNum=parseInt(this.params.OFFER_SELECTED,10)||0),this.params.TREE_PROPS&&(this.treeProps=this.params.TREE_PROPS),this.params.DEFAULT_PICTURE&&(this.defaultPict.preview=this.params.DEFAULT_PICTURE.PREVIEW_PICTURE,this.defaultPict.detail=this.params.DEFAULT_PICTURE.DETAIL_PICTURE),this.params.PRODUCT&&"object"==typeof this.params.PRODUCT&&(this.product.id=parseInt(this.params.PRODUCT.ID,10),this.product.name=this.params.PRODUCT.NAME,this.product.category=this.params.PRODUCT.CATEGORY,this.product.detailText=this.params.PRODUCT.DETAIL_TEXT,this.product.detailTextType=this.params.PRODUCT.DETAIL_TEXT_TYPE,this.product.previewText=this.params.PRODUCT.PREVIEW_TEXT,this.product.previewTextType=this.params.PRODUCT.PREVIEW_TEXT_TYPE)):this.errorCode=-1},initBasketData:function(){this.params.BASKET&&"object"==typeof this.params.BASKET&&(1!==this.productType&&2!==this.productType||(this.basketData.useProps=this.params.BASKET.ADD_PROPS,this.basketData.emptyProps=this.params.BASKET.EMPTY_PROPS),this.params.BASKET.QUANTITY&&(this.basketData.quantity=this.params.BASKET.QUANTITY),this.params.BASKET.PROPS&&(this.basketData.props=this.params.BASKET.PROPS),this.params.BASKET.BASKET_URL&&(this.basketData.basketUrl=this.params.BASKET.BASKET_URL),3===this.productType&&this.params.BASKET.SKU_PROPS&&(this.basketData.sku_props=this.params.BASKET.SKU_PROPS),this.params.BASKET.ADD_URL_TEMPLATE&&(this.basketData.add_url=this.params.BASKET.ADD_URL_TEMPLATE),this.params.BASKET.BUY_URL_TEMPLATE&&(this.basketData.buy_url=this.params.BASKET.BUY_URL_TEMPLATE),""===this.basketData.add_url&&""===this.basketData.buy_url&&(this.errorCode=-1024))},initCompareData:function(){this.config.useCompare&&(this.params.COMPARE&&"object"==typeof this.params.COMPARE?(this.params.COMPARE.COMPARE_PATH&&(this.compareData.comparePath=this.params.COMPARE.COMPARE_PATH),this.params.COMPARE.COMPARE_URL_TEMPLATE?this.compareData.compareUrl=this.params.COMPARE.COMPARE_URL_TEMPLATE:this.config.useCompare=!1,this.params.COMPARE.COMPARE_DELETE_URL_TEMPLATE?this.compareData.compareDeleteUrl=this.params.COMPARE.COMPARE_DELETE_URL_TEMPLATE:this.config.useCompare=!1):this.config.useCompare=!1)},initSlider:function(){if(this.isTouchDevice)this.slider.options.interval=!1;else if(this.product.slider.CONT){var t=this.product.slider.CONT.querySelectorAll("[data-go-to]");for(var i in t)t.hasOwnProperty(i)&&(BX.bind(t[i],"mouseenter",BX.proxy(this.sliderHoverOnHandler,this)),BX.bind(t[i],"mouseleave",BX.proxy(this.sliderHoverOffHandler,this)))}},setAnalyticsDataLayer:function(i){if(this.config.useEnhancedEcommerce&&this.config.dataLayerName){var s,e,a,r,n,o,h={},c={},u=[];switch(this.productType){case 0:case 1:case 2:h={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,category:this.product.category,brand:BX.type.isArray(this.config.brandProperty)?this.config.brandProperty.join("/"):this.config.brandProperty};break;case 3:for(s in this.offers[this.offerNum].TREE)if(this.offers[this.offerNum].TREE.hasOwnProperty(s))for(e in r=s.substring(5),n=this.offers[this.offerNum].TREE[s],this.treeProps)if(this.treeProps.hasOwnProperty(e)&&this.treeProps[e].ID==r)for(a in this.treeProps[e].VALUES)if((o=this.treeProps[e].VALUES[a]).ID==n){u.push(o.NAME);break}h={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,category:this.product.category,brand:BX.type.isArray(this.config.brandProperty)?this.config.brandProperty.join("/"):this.config.brandProperty,variant:u.join("/")}}switch(i){case"showDetail":c={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",detail:{products:[{name:h.name||"",id:h.id||"",price:h.price||0,brand:h.brand||"",category:h.category||"",variant:h.variant||""}]}}};break;case"addToCart":c={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:h.name||"",id:h.id||"",price:h.price||0,brand:h.brand||"",category:h.category||"",variant:h.variant||"",quantity:this.config.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}}}t[this.config.dataLayerName]=t[this.config.dataLayerName]||[],t[this.config.dataLayerName].push(c)}},checkTouch:function(t){return!(!t||!t.changedTouches)&&t.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(t){1==t.touches.length&&(this.touch=t.changedTouches[0])},touchEndEvent:function(t){if(this.checkTouch(t)){var i=this.touch.pageX-t.changedTouches[0].pageX,s=this.touch.pageY-t.changedTouches[0].pageY;Math.abs(i)>=Math.abs(s)+10&&(i>0&&this.slideNext(),i<0&&this.slidePrev())}},sliderHoverOnHandler:function(t){var i=BX.proxy_context.getAttribute("data-go-to");this.slideShow(i),BX.PreventDefault(t)},sliderHoverOffHandler:function(t){this.slideShow(0)},slideShow:function(t){var i=this.node.imageContainer.querySelectorAll("img"),s=this.product.slider.CONT.querySelectorAll("[data-go-to]");for(var e in s)s.hasOwnProperty(e)&&BX.removeClass(s[e],"active");for(var e in s[this.getItemIndex(this.eq(this.product.slider.ITEMS,t))]&&BX.addClass(s[this.getItemIndex(this.eq(this.product.slider.ITEMS,t))],"active"),i)i.hasOwnProperty(e)&&BX.removeClass(i[e].parentNode,"active");i[this.getItemIndex(this.eq(this.product.slider.ITEMS,t))]&&BX.addClass(i[this.getItemIndex(this.eq(this.product.slider.ITEMS,t))].parentNode,"active")},slideNext:function(){return this.slide("next")},slidePrev:function(){return this.slide("prev")},slide:function(t){if(this.product.slider&&this.product.slider.CONT){var i=this.getEntity(this.product.slider.CONT,"slider-control",".active"),s=this.getItemForDirection(t,i);BX.removeClass(i,"active"),this.selectSliderImg(s),this.slider.interval&&this.cycleSlider()}},getItemForDirection:function(t,i){var s=(this.getItemIndex(i)+("prev"===t?-1:1))%this.product.slider.COUNT;return this.eq(this.product.slider.ITEMS,s)},getItemIndex:function(t){return BX.util.array_values(this.product.slider.ITEMS).indexOf(t)},eq:function(t,i){var s=t.length,e=+i+(i<0?s:0);return e>=0&&e<s?t[e]:{}},setCurrentImg:function(t,i,s){var e,a;if(this.currentImg.id=t.ID,this.currentImg.src=t.SRC,this.currentImg.width=t.WIDTH,this.currentImg.height=t.HEIGHT,i&&this.node.imageContainer)for(a=(e=this.getEntities(this.node.imageContainer,"image")).length;a--;)e[a].getAttribute("data-id")==t.ID?(BX.hasClass(e[a],"active")||this.node.sliderProgressBar&&this.resetProgress(),BX.addClass(e[a],"active")):BX.hasClass(e[a],"active")&&BX.removeClass(e[a],"active");this.config.useMagnifier&&!this.isTouchDevice&&(this.setMagnifierParams(),i&&this.disableMagnifier(!0))},setMagnifierParams:function(){for(var t,i=this.getEntities(this.node.imageContainer,"image"),s=i.length;s--;)(t=i[s].querySelector("img")).setAttribute("data-title",t.getAttribute("title")||""),t.removeAttribute("title"),i[s].getAttribute("data-id")==this.currentImg.id&&(BX.unbind(this.currentImg.node,"mouseover",BX.proxy(this.enableMagnifier,this)),this.currentImg.node=t,this.currentImg.node.style.backgroundImage="url('"+this.currentImg.src+"')",this.currentImg.node.style.backgroundSize="100% auto",BX.bind(this.currentImg.node,"mouseover",BX.proxy(this.enableMagnifier,this)))},enableMagnifier:function(){BX.bind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this))},disableMagnifier:function(t){this.magnify.enabled&&(clearTimeout(this.magnify.timer),BX.removeClass(this.obBigSlider,"magnified"),this.magnify.enabled=!1,this.currentImg.node.style.backgroundSize="100% auto",t?(this.currentImg.node.style.height=this.magnify.height+"px",this.currentImg.node.style.width=this.magnify.width+"px",this.magnify.timer=setTimeout(BX.delegate(function(){this.currentImg.node.src=this.currentImg.src,this.currentImg.node.style.height="",this.currentImg.node.style.width=""},this),250)):(this.currentImg.node.src=this.currentImg.src,this.currentImg.node.style.height="",this.currentImg.node.style.width=""),BX.unbind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this)))},moveMagnifierArea:function(t){var i=BX.pos(this.currentImg.node),s=this.inRect(t,i);if(this.inBound(i,s)){var e,a,r,n,o,h=s.X/this.currentImg.node.width*100,c=s.Y/this.currentImg.node.height*100;this.currentImg.node.style.backgroundPosition=h+"% "+c+"%",this.magnify.enabled||(clearTimeout(this.magnify.timer),BX.addClass(this.obBigSlider,"magnified"),this.currentImg.node.style.height=(this.magnify.height=this.currentImg.node.clientHeight)+"px",this.currentImg.node.style.width=(this.magnify.width=this.currentImg.node.offsetWidth)+"px",e=this.currentImg.width/this.currentImg.height,(a=this.obBigSlider.offsetWidth)>this.currentImg.width&&!BX.hasClass(this.obBigSlider,"popup")?(n=(r=a)/e,o=100):(r=this.currentImg.width,n=this.currentImg.height,o=this.config.magnifierZoomPercent>100?this.config.magnifierZoomPercent:100),this.currentImg.node.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12P4zwAAAgEBAKrChTYAAAAASUVORK5CYII=",this.currentImg.node.style.backgroundSize=o+"% auto",this.magnify.timer=setTimeout(BX.delegate(function(){this.currentImg.node.style.height=n+"px",this.currentImg.node.style.width=r+"px"},this),10)),this.magnify.enabled=!0}else this.disableMagnifier(!0)},inBound:function(t,i){return i.Y>=0&&t.height>=i.Y&&i.X>=0&&t.width>=i.X},inRect:function(t,i){var s=BX.GetWindowSize(),e={X:0,Y:0,globalX:0,globalY:0};return e.globalX=t.clientX+s.scrollLeft,t.offsetX&&t.offsetX<0&&(e.globalX-=t.offsetX),e.X=e.globalX-i.left,e.globalY=t.clientY+s.scrollTop,t.offsetY&&t.offsetY<0&&(e.globalY-=t.offsetY),e.Y=e.globalY-i.top,e},startQuantityInterval:function(){var t=BX.proxy_context.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate(function(){this.quantityTimer=setInterval(t,150)},this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay),clearInterval(this.quantityTimer)},quantityUp:function(){var t=0,i=!0;0===this.errorCode&&this.config.showQuantity&&this.canBuy&&!this.isGift&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t+=this.stepQuantity,t=this.checkQuantityRange(t,"up"),this.checkQuantity&&t>this.maxQuantity&&(i=!1),i&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t,this.setPrice())))},quantityDown:function(){var t=0,i=!0;0===this.errorCode&&this.config.showQuantity&&this.canBuy&&!this.isGift&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t-=this.stepQuantity,(t=this.checkQuantityRange(t,"down"))<this.minQuantity&&(i=!1),i&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t,this.setPrice())))},quantityChange:function(){var t,i=0;0===this.errorCode&&this.config.showQuantity&&(this.canBuy?(i=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value),isNaN(i)?this.obQuantity.value=this.minQuantity:(i=this.checkQuantityRange(i),this.checkQuantity&&i>this.maxQuantity&&(i=this.maxQuantity),this.checkPriceRange(i),i=(t=Math.floor(Math.round(i*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1)<=1?this.stepQuantity:t*this.stepQuantity,(i=Math.round(i*this.precisionFactor)/this.precisionFactor)<this.minQuantity&&(i=this.minQuantity),this.obQuantity.value=i)):this.obQuantity.value=this.minQuantity,this.setPrice())},quantitySet:function(t){var i,s,e=this.offers[t],a=this.offers[this.offerNum];if(0===this.errorCode){if(this.canBuy=e.CAN_BUY,this.currentPriceMode=e.ITEM_PRICE_MODE,this.currentPrices=e.ITEM_PRICES,this.currentAllPrices=e.ITEM_ALL_PRICES,this.currentPriceSelected=e.ITEM_PRICE_SELECTED,this.currentQuantityRanges=e.ITEM_QUANTITY_RANGES,this.currentQuantityRangeSelected=e.ITEM_QUANTITY_RANGE_SELECTED,this.canBuy?(this.node.quantity&&BX.style(this.node.quantity,"display",""),this.obBasketActions&&BX.style(this.obBasketActions,"display",""),this.obSubscribe&&BX.style(this.obSubscribe,"display","none")):(this.node.quantity&&BX.style(this.node.quantity,"display","none"),this.obBasketActions&&BX.style(this.obBasketActions,"display","none"),this.obSubscribe&&("Y"===e.CATALOG_SUBSCRIBE?(BX.style(this.obSubscribe,"display",""),this.obSubscribe.setAttribute("data-item",e.ID),BX(this.visual.SUBSCRIBE_LINK+"_hidden").click()):BX.style(this.obSubscribe,"display","none"))),this.isDblQuantity=e.QUANTITY_FLOAT,this.checkQuantity=e.CHECK_QUANTITY,this.isDblQuantity?(this.stepQuantity=Math.round(parseFloat(e.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor,this.maxQuantity=parseFloat(e.MAX_QUANTITY),this.minQuantity="Q"===this.currentPriceMode?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity):(this.stepQuantity=parseInt(e.STEP_QUANTITY,10),this.maxQuantity=parseInt(e.MAX_QUANTITY,10),this.minQuantity="Q"===this.currentPriceMode?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity),!this.canBuy||this.checkQuantity&&0==this.maxQuantity?this.obNotAvail&&BX.style(this.obNotAvail,"display",""):this.obNotAvail&&BX.style(this.obNotAvail,"display","none"),this.config.showQuantity){var r=a.ITEM_PRICES.length&&a.ITEM_PRICES[a.ITEM_PRICE_SELECTED]&&a.ITEM_PRICES[a.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;s=this.isDblQuantity?Math.round(parseFloat(a.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||r||a.MEASURE!==e.MEASURE||this.checkQuantity&&parseFloat(a.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity:parseInt(a.STEP_QUANTITY,10)!==this.stepQuantity||r||a.MEASURE!==e.MEASURE||this.checkQuantity&&parseInt(a.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity,this.obQuantity.disabled=!this.canBuy,s&&(this.obQuantity.value=this.minQuantity),this.obMeasure&&(e.MEASURE?BX.adjust(this.obMeasure,{html:e.MEASURE}):BX.adjust(this.obMeasure,{html:""}))}if(this.obQuantityLimit.all&&(this.canBuy&&this.checkQuantity&&0!=this.maxQuantity?("M"===this.config.showMaxQuantity?i=this.maxQuantity/this.stepQuantity>=this.config.relativeQuantityFactor?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW"):(i=this.maxQuantity,e.MEASURE&&(i+=" "+e.MEASURE)),BX.adjust(this.obQuantityLimit.value,{html:i}),BX.adjust(this.obQuantityLimit.all,{attrs:{className:this.maxQuantity/this.stepQuantity>=this.config.relativeQuantityFactor?"product-cat-limit is-instock":"product-cat-limit is-limited"},style:{display:""}})):(BX.adjust(this.obQuantityLimit.value,{html:""}),BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}}))),this.config.usePriceRanges)if(this.config.fillAllPrices){var n=this.currentAllPrices[this.currentPriceSelected],o=this.getEntities(this.obProduct,"price-ranges-block");if(null!=n)for(var h in o)if(o.hasOwnProperty(h)&&BX.type.isDomNode(o[h]))for(var c in n.PRICES){if((d=n.PRICES[c].PRICE_TYPE_ID)===o[h].getAttribute("data-price-id")){if("Q"===this.currentPriceMode&&e.PRICE_RANGES_HTML[d]){var u=this.getEntity(o[h],"price-ranges-body"),l=this.getEntity(o[h],"price-ranges-ratio-header");u&&(u.innerHTML=e.PRICE_RANGES_HTML[d]),l&&(l.innerHTML=e.PRICE_RANGES_RATIO_HTML),this.showMultiPrice=!0,o[h].style.display="",o[h].parentNode.style.display=""}else o[h].style.display="none",o[h].parentNode.style.display="none";break}}}else if(this.config.usePriceRanges&&this.obPriceRanges){var d=this.currentPrices[this.currentPriceSelected].PRICE_TYPE_ID;if("Q"===this.currentPriceMode&&e.PRICE_RANGES_HTML){u=this.getEntity(this.obPriceRanges,"price-ranges-body"),l=this.getEntity(this.obPriceRanges,"price-ranges-ratio-header");u&&(u.innerHTML=e.PRICE_RANGES_HTML[d]),l&&(l.innerHTML=e.PRICE_RANGES_RATIO_HTML),this.obPriceRanges.style.display=""}else this.obPriceRanges.style.display="none"}}},selectOfferProp:function(){var t=0,i=[],s=null,e=BX.proxy_context;if(e&&e.hasAttribute("data-treevalue")){if(BX.hasClass(e,"checked"))return;if("object"==typeof document.activeElement&&document.activeElement.blur(),i=e.getAttribute("data-treevalue").split("_"),this.searchOfferPropIndex(i[0],i[1]),(s=BX.findChildren(e.parentNode,{tagName:"li"},!1))&&s.length)for(t=0;t<s.length;t++)BX.removeClass(s[t],"checked");BX.addClass(e,"checked"),this.setOfferCurrentValue(BX.findParent(e,{attribute:{"data-entity":"sku-line-block"}}),e),this.isFacebookConversionCustomizeProductEventEnabled&&BX.Type.isArrayFilled(this.offers)&&BX.Type.isObject(this.offers[this.offerNum])&&BX.ajax.runAction("sale.facebookconversion.customizeProduct",{data:{offerId:this.offers[this.offerNum].ID}})}},searchOfferPropIndex:function(t,i){var s,e,a="",r=!1,n=[],o=[],h=-1,c={},u=[];for(s=0;s<this.treeProps.length;s++)if(this.treeProps[s].ID===t){h=s;break}if(h>-1){for(s=0;s<h;s++)c[a="PROP_"+this.treeProps[s].ID]=this.selectedValues[a];for(c[a="PROP_"+this.treeProps[h].ID]=i,s=h+1;s<this.treeProps.length&&(a="PROP_"+this.treeProps[s].ID,r=this.getRowValues(c,a));s++){if(o=[],this.config.showAbsent)for(n=[],u=[],u=BX.clone(c,!0),e=0;e<r.length;e++)u[a]=r[e],o[o.length]=r[e],this.getCanBuy(u)&&(n[n.length]=r[e]);else n=r;this.selectedValues[a]&&BX.util.in_array(this.selectedValues[a],n)?c[a]=this.selectedValues[a]:this.config.showAbsent?c[a]=n.length?n[0]:o[0]:c[a]=n[0],this.updateRow(s,c[a],r,n)}this.selectedValues=c,this.changeInfo()}},updateRow:function(t,i,s,e){var a=0,r="",n=!1,o=null,h=this.getEntities(this.obTree,"sku-line-block");if(t>-1&&t<h.length){var c;for(o=h[t].querySelectorAll("li"),a=0;a<o.length;a++)(n=(r=o[a].getAttribute("data-onevalue"))===i)?BX.addClass(o[a],"checked"):BX.removeClass(o[a],"checked"),BX.util.in_array(r,e)?BX.removeClass(o[a],"disabled"):BX.addClass(o[a],"disabled"),BX.removeClass(o[a],"last-visible"),BX.util.in_array(r,s)?(c=o[a],o[a].style.display=""):o[a].style.display="none",n&&(h[t].style.display=0==r&&1==e.length?"none":"",this.setOfferCurrentValue(h[t],o[a]));c&&BX.addClass(c,"last-visible")}},getRowValues:function(t,i){var s=[],e=0,a=0,r=!1,n=!0;if(0===t.length){for(e=0;e<this.offers.length;e++)BX.util.in_array(this.offers[e].TREE[i],s)||(s[s.length]=this.offers[e].TREE[i]);r=!0}else for(e=0;e<this.offers.length;e++){for(a in n=!0,t)if(t[a]!==this.offers[e].TREE[a]){n=!1;break}n&&(BX.util.in_array(this.offers[e].TREE[i],s)||(s[s.length]=this.offers[e].TREE[i]),r=!0)}return!!r&&s},getCanBuy:function(t){var i,s=0,e=!0,a=!1;for(i=0;i<this.offers.length;i++){for(s in e=!0,t)if(t[s]!==this.offers[i].TREE[s]){e=!1;break}if(e&&this.offers[i].CAN_BUY){a=!0;break}}return a},setCurrent:function(){var t,i=0,s="",e=!1,a=[],r={},n=[],o=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(s="PROP_"+this.treeProps[t].ID,e=this.getRowValues(r,s));t++){if(BX.util.in_array(o[s],e)?r[s]=o[s]:(r[s]=e[0],this.offerNum=0),this.config.showAbsent)for(a=[],n=[],n=BX.clone(r,!0),i=0;i<e.length;i++)n[s]=e[i],this.getCanBuy(n)&&(a[a.length]=e[i]);else a=e;this.updateRow(t,r[s],e,a)}this.selectedValues=r,this.changeInfo()},changeInfo:function(){var t,i,s=-1,e=0,a=!0,r={currentId:this.offerNum>-1?this.offers[this.offerNum].ID:0,newId:0};for(t=0;t<this.offers.length;t++){for(e in a=!0,this.selectedValues)if(this.selectedValues[e]!==this.offers[t].TREE[e]){a=!1;break}if(a){s=t;break}}if(s>-1){for(s!=this.offerNum&&(this.isGift=!1),t=0;t<this.offers.length;t++)this.config.showOfferGroup&&this.offers[t].OFFER_GROUP&&(i=BX(this.visual.OFFER_GROUP+this.offers[t].ID))&&(i.style.display=t==s?"":"none");if(this.offers[s].SLIDER_COUNT>0){var n,o,h;for(t in BX.cleanNode(this.node.imageContainer),this.offers[s].SLIDER)if(this.offers[s].SLIDER.hasOwnProperty(t)&&((o=this.offers[s].SLIDER[t]).RESIZE&&(o.SRC=o.RESIZE.big.src,o.WIDTH=o.RESIZE.big.width,o.HEIGHT=o.RESIZE.big.height),h=BX.create("IMG",{props:{className:"product-cat-image"},attrs:{src:o.SRC,width:o.WIDTH,height:o.HEIGHT,alt:this.config.alt,title:this.config.title}}),n=BX.create("span",{props:{className:"product-cat-image-slide item"+(0==t?" active":"")},children:[h]}),this.node.imageContainer.appendChild(n),t>this.sliderSlideCount-2&&this.offers[s].SLIDER_COUNT>this.sliderSlideCount)){var c=BX.message("SLIDER_MORE_MESSAGE");c=c.replace("#NUMBER#",this.offers[s].SLIDER_COUNT-this.sliderSlideCount),n.appendChild(BX.create("span",{props:{className:"product-cat-image-slider-more"},children:[BX.create("span",{props:{className:"product-cat-image-slider-more-wrapper"},children:[BX.create("span",{props:{className:"product-cat-image-slider-more-icon"},html:'<svg class="icon-svg"><use xlink:href="#svg-camera"></use></svg>'}),BX.create("span",{props:{className:"product-cat-image-slider-more-text"},text:c})]})]}));break}if(this.product.slider.CONT){for(t in BX.cleanNode(this.product.slider.CONT),this.offers[s].SLIDER)if(this.offers[s].SLIDER.hasOwnProperty(t)&&(this.product.slider.CONT.appendChild(BX.create("span",{attrs:{"data-go-to":t,"data-entity":"slider-control"},props:{className:"product-cat-image-slider-control"+(0==t?" active":"")}})),t>=this.sliderSlideCount-1))break;this.product.slider.ITEMS=this.getEntities(this.product.slider.CONT,"slider-control"),this.product.slider.CONT.style.display=""}this.offers[s].SLIDER_COUNT>1&&this.initSlider(s),this.obDescription&&"Y"===this.config.showSkuDescription&&this.changeSkuDescription(s)}if(this.config.showSkuProps&&(this.obSkuProps&&(this.offers[s].DISPLAY_PROPERTIES?BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[s].DISPLAY_PROPERTIES}):BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})),this.obMainSkuProps&&(this.offers[s].DISPLAY_PROPERTIES_MAIN_BLOCK?BX.adjust(this.obMainSkuProps,{style:{display:""},html:this.offers[s].DISPLAY_PROPERTIES_MAIN_BLOCK}):BX.adjust(this.obMainSkuProps,{style:{display:"none"},html:""}))),this.offers[s].PROPERTIES&&"object"==typeof this.offers[s].PROPERTIES)for(var u in this.offers[s].PROPERTIES){var l=this.offers[s].PROPERTIES[u];if(l){var d=this.getEntity(this.obProduct,"sku-prop-"+l.ID);d&&BX.adjust(d,{html:l.VALUE})}}this.obBuy1clickBtn&&this.obBuy1clickBtn.setAttribute("href",this.config.buy1ClickUrl.replace("#ELEMENT_ID#",this.offers[s].ID)),this.obProductRequestBtn&&this.obProductRequestBtn.setAttribute("href",this.config.productRequestUrl.replace("#ELEMENT_ID#",this.offers[s].ID)),this.config.useOfferName&&this.obName&&(this.obName.innerHTML=BX.Text.encode(this.offers[s].NAME)),this.showMultiPrice=!1,this.quantitySet(s),this.setPrice(),this.setCompared(this.offers[s].COMPARED),this.offerNum=s,this.setAnalyticsDataLayer("showDetail"),this.incViewedCounter(),r.newId=this.offers[this.offerNum].ID,BX.onCustomEvent("onCatalogStoreProductChange",[this.offers[this.offerNum].ID]),BX.onCustomEvent("onCatalogElementChangeOffer",[r]),r=null,this.setCartStatus(),this.obSaleBanner&&this.offers[this.offerNum].TIMER&&this.setTimer(this.offers[this.offerNum].TIMER),this.obPricesAll&&(this.showMultiPrice?this.obPricesAll.style.display="":this.obPricesAll.style.display="none")}},changeSkuDescription:function(t){var i="";if(this.obDescription){""!==this.offers[t].DETAIL_TEXT?i="html"===this.offers[t].DETAIL_TEXT_TYPE?this.offers[t].DETAIL_TEXT:"<p>"+this.offers[t].DETAIL_TEXT+"</p>":""!==this.product.detailText&&(i="html"===this.product.detailTextType?this.product.detailText:"<p>"+this.product.detailText+"</p>");var s=this.obDescription.closest('[data-entity="description"]');""!==i?(this.obDescription.innerHTML=i,s.classList.contains("tab-pane")?this.showDescriptionTab(s):s.style.display=""):(this.obDescription.innerHTML="",s.classList.contains("tab-pane")?this.hideDescriptionTab(s):s.style.display="none")}},showDescriptionTab:function(t){var i,s=document.getElementById(t.getAttribute("aria-labelledby"));t.style.display="",s&&(s.classList.contains("active")||(s.parentNode.style.display="",(i=Array.from(s.parentNode.parentNode.children).filter(function(t){return t.firstElementChild&&t.firstElementChild.classList.contains("active")})[0])&&$(i.firstElementChild).trigger("shown.bs.tab")))},hideDescriptionTab:function(t){var i,s=document.getElementById(t.getAttribute("aria-labelledby"));t.style.display="none",s&&(i=s.classList.contains("active")?Array.from(s.parentNode.parentNode.children).filter(function(t){return t!=s.parentNode})[0]:Array.from(s.parentNode.parentNode.children).filter(function(t){return t.firstElementChild&&t.firstElementChild.classList.contains("active")})[0],s.parentNode.style.display="none",i&&$(i.firstElementChild).tab("show"))},drawImages:function(t){if(this.node.imageContainer){var i,s,e,a,r=t.SLIDER,n=$(this.node.imageContainer),o=n.data("owl.carousel");if(null!=o)for(i=0,e=o._items.length;i<e;i++)n.trigger("remove.owl.carousel",i);for(i=0;i<r.length;i++)(a=r[i]).RESIZE&&(a.SRC=a.RESIZE.big.src,a.WIDTH=a.RESIZE.big.width,a.HEIGHT=a.RESIZE.big.height),s=BX.create("IMG",{attrs:{src:a.SRC,width:a.WIDTH,height:a.HEIGHT,alt:this.config.alt,title:this.config.title}}),0==i&&s.setAttribute("itemprop","image"),this.config.useLazyImages&&s.setAttribute("loading","lazy"),s=BX.create("SPAN",{attrs:{"data-entity":"image","data-fancybox":"gallery","data-caption":this.config.title,"data-index":i,"data-src":r[i].SRC,"data-dot":'<button class="owl-preview" style="background-image:url('+(r[i].RESIZE?r[i].RESIZE.small.src:r[i].SRC)+')"></button>'},props:{className:"product-detail-slider-image"},children:[s]}),null!=o&&n.trigger("add.owl.carousel",s).trigger("refresh.owl.carousel").resize()}},restoreSticker:function(){this.previousStickerText?this.redrawSticker({text:this.previousStickerText}):this.hideSticker()},hideSticker:function(){BX.hide(BX(this.visual.STICKER_ID))},redrawSticker:function(t){var i=(t=t||{}).text||"",s=BX(this.visual.STICKER_ID);if(s){BX.show(s);var e=s.getAttribute("title");e&&e!=i&&(this.previousStickerText=e),BX.adjust(s,{text:i,attrs:{title:i}})}},checkQuantityRange:function(t,i){if(void 0===t||"Q"!==this.currentPriceMode)return t;var s,e,a,r,n,o,h=t=parseFloat(t);for(var c in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(c)){if(s=this.currentQuantityRanges[c],parseFloat(t)>=parseFloat(s.SORT_FROM)&&("INF"===s.SORT_TO||parseFloat(t)<=parseFloat(s.SORT_TO))){h=t;break}e=parseFloat(s.SORT_FROM)-t,a=Math.abs(e),r=parseFloat(s.SORT_TO)-t,n=Math.abs(r),(void 0===o||o>a)&&(void 0===i||"up"===i&&e>0||"down"===i&&e<0)&&(o=a,h=parseFloat(s.SORT_FROM)),(void 0===o||o>n)&&(void 0===i||"up"===i&&e>0||"down"===i&&e<0)&&(o=n,h=parseFloat(s.SORT_TO))}return h},checkPriceRange:function(t){if(void 0!==t&&"Q"===this.currentPriceMode){var i,s=!1;for(var e in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(e)&&(i=this.currentQuantityRanges[e],parseFloat(t)>=parseFloat(i.SORT_FROM)&&("INF"===i.SORT_TO||parseFloat(t)<=parseFloat(i.SORT_TO)))){s=!0,this.currentQuantityRangeSelected=i.HASH;break}for(var a in!s&&(i=this.getMinPriceRange())&&(this.currentQuantityRangeSelected=i.HASH),this.currentPrices)if(this.currentPrices.hasOwnProperty(a)&&this.currentPrices[a].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=a;break}}},getMinPriceRange:function(){var t;for(var i in this.currentQuantityRanges)this.currentQuantityRanges.hasOwnProperty(i)&&(!t||parseInt(this.currentQuantityRanges[i].SORT_FROM)<parseInt(t.SORT_FROM))&&(t=this.currentQuantityRanges[i]);return t},checkQuantityControls:function(){if(this.obQuantity){var t=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,i=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;t?BX.addClass(this.obQuantityUp,"product-cat-amount-field-btn-disabled"):BX.hasClass(this.obQuantityUp,"product-cat-amount-field-btn-disabled")&&BX.removeClass(this.obQuantityUp,"product-cat-amount-field-btn-disabled"),i?BX.addClass(this.obQuantityDown,"product-cat-amount-field-btn-disabled"):BX.hasClass(this.obQuantityDown,"product-cat-amount-field-btn-disabled")&&BX.removeClass(this.obQuantityDown,"product-cat-amount-field-btn-disabled"),t&&i?this.obQuantity.setAttribute("disabled","disabled"):this.obQuantity.removeAttribute("disabled")}},setPrice:function(){var t;if(this.obQuantity&&this.checkPriceRange(this.obQuantity.value),this.checkQuantityControls(),t=this.currentPrices[this.currentPriceSelected],this.config.fillAllPrices&&null!=this.currentAllPrices){var i,s=this.currentAllPrices[this.currentPriceSelected],e=this.getEntities(this.obProduct,"price"),a=0;for(var r in e)if(e.hasOwnProperty(r)&&BX.type.isDomNode(e[r])&&null!==e[r].getAttribute("data-price-id")&&null!=s)for(i in s.PRICES){var n=s.PRICES[i];if(n.PRICE_TYPE_ID===e[r].getAttribute("data-price-id")){a++,e[r].style.display="",this.updatePrice(e[r],n);break}e[r].style.display="none"}a>1&&(this.showMultiPrice=!0)}else{var o=this.getEntity(this.obProduct,"price");this.updatePrice(o,t)}this.obPrice.total&&(t&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity?BX.adjust(this.obPrice.total,{html:BX.message("PRICE_TOTAL_PREFIX")+': <span class="price-total-value">'+(0==this.productType?t.CURRENCY.replace("#",BX.util.number_format(t.PRICE*this.obQuantity.value,0,"."," ")):BX.Currency.currencyFormat(t.PRICE*this.obQuantity.value,t.CURRENCY,!0))+"</span>",style:{display:""}}):BX.adjust(this.obPrice.total,{html:"",style:{display:"none"}}))},updatePrice:function(t,i){var s="",e=this.getEntity(t,"price-current"),a=this.getEntity(t,"price-full"),r=this.getEntity(t,"price-discount"),n=this.getEntity(t,"cashback");this.isGift&&(i.PRICE=0,i.DISCOUNT=i.BASE_PRICE,i.PERCENT=100),e&&(i?BX.adjust(e,{html:0==this.productType?i.PRINT_RATIO_PRICE:BX.Currency.currencyFormat(i.RATIO_PRICE,i.CURRENCY,!0)}):BX.adjust(e,{html:""}),i&&i.RATIO_PRICE!==i.RATIO_BASE_PRICE?this.config.showOldPrice&&(a&&BX.adjust(a,{style:{display:""},html:0==this.productType?i.PRINT_RATIO_BASE_PRICE:BX.Currency.currencyFormat(i.RATIO_BASE_PRICE,i.CURRENCY,!0)}),r&&(s=(s=BX.message("ECONOMY_INFO_MESSAGE")).replace("#ECONOMY#",0==this.productType?i.PRINT_RATIO_DISCOUNT:BX.Currency.currencyFormat(i.RATIO_DISCOUNT,i.CURRENCY,!0)),BX.adjust(r,{style:{display:""},html:s}))):this.config.showOldPrice&&(a&&BX.adjust(a,{style:{display:"none"},html:""}),r&&BX.adjust(r,{style:{display:"none"},html:""})),n&&(i.RATIO_BONUS>0?(n.style.display="",this.getEntity(n,"cashback-value").innerHTML=0==this.productType?i.CURRENCY.replace("#",BX.util.number_format(i.RATIO_BONUS*this.obQuantity.value,0,"."," ")):BX.Currency.currencyFormat(i.RATIO_BONUS*this.obQuantity.value,i.CURRENCY,!0)):n.style.display="none"))},compare:function(t){var i=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),s=BX.getEventTarget(t),e=!0;i&&(e=s===i?i.checked:!i.checked);var a,r=e?this.compareData.compareUrl:this.compareData.compareDeleteUrl;if(r){switch(s!==i&&(BX.PreventDefault(t),this.setCompared(e)),this.productType){case 0:case 1:case 2:a=r.replace("#ID#",this.product.id.toString());break;case 3:a=r.replace("#ID#",this.offers[this.offerNum].ID)}BX.ajax({method:"POST",dataType:e?"json":"html",url:a+(-1!==a.indexOf("?")?"&":"?")+"ajax_action=Y",onsuccess:e?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(t){var s,e;BX.type.isPlainObject(t)&&(this.offers.length>0&&(this.offers[this.offerNum].COMPARED="OK"===t.STATUS),"OK"===t.STATUS?BX.onCustomEvent("OnCompareChange",[{action:"add",id:t.ID}]):(this.initPopupWindow(),s='<div class="alert alert-danger">'+(t.MESSAGE?t.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</div>",e=[new i({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})],this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE")),this.obPopupWin.setContent(s),this.obPopupWin.setButtons(e),this.obPopupWin.show()))},compareDeleteResult:function(t){"OK"===(t=BX.parseJSON(t)).STATUS&&BX.onCustomEvent("OnCompareChange",[{action:"delete",id:t.ID}]),this.offers&&this.offers.length&&(this.offers[this.offerNum].COMPARED=!1)},checkCompare:function(t){if(null!=t)switch(this.productType){case 0:case 1:case 2:this.product.id==t.id&&this.setCompared("add"==t.action);break;case 3:for(var i=this.offers.length;i--;)if(this.offers[i].ID==t.id){this.offers[i].COMPARED=!1,this.offerNum==i&&this.setCompared("add"==t.action);break}}},setCompared:function(t){if(this.obCompare){t?BX.addClass(this.obCompare,"checked"):BX.removeClass(this.obCompare,"checked");var i=this.getEntity(this.obCompare,"compare-checkbox");i&&(i.checked=t);var s=this.getEntity(this.obCompare,"compare-title");s&&(s.innerHTML=t?BX.message("BTN_COMPARE_DEL"):BX.message("BTN_COMPARE_ADD"))}},setCompareInfo:function(t){if(BX.type.isArray(t))for(var i in this.offers)this.offers.hasOwnProperty(i)&&(this.offers[i].COMPARED=BX.util.in_array(this.offers[i].ID,t))},compareRedirect:function(){this.compareData.comparePath?location.href=this.compareData.comparePath:this.obPopupWin.close()},checkDeletedCompare:function(t){switch(this.productType){case 0:case 1:case 2:this.product.id==t&&this.setCompared(!1);break;case 3:for(var i=this.offers.length;i--;)if(this.offers[i].ID==t){this.offers[i].COMPARED=!1,this.offerNum==i&&this.setCompared(!1);break}}},initBasketUrl:function(){switch(this.basketUrl="ADD"===this.basketMode?this.basketData.add_url:this.basketData.buy_url,this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID)}this.basketParams={ajax_basket:"Y"},this.config.showQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value),this.basketData.sku_props&&(this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props)},fillBasketProps:function(){if(this.visual.BASKET_PROP_DIV){var t=0,i=null,s=!1,e=null;if(this.basketData.useProps&&!this.basketData.emptyProps?this.obPopupWin&&this.obPopupWin.contentContainer&&(e=this.obPopupWin.contentContainer):e=BX(this.visual.BASKET_PROP_DIV),e){if((i=e.getElementsByTagName("select"))&&i.length)for(t=0;t<i.length;t++)if(!i[t].disabled)switch(i[t].type.toLowerCase()){case"select-one":this.basketParams[i[t].name]=i[t].value,s=!0}if((i=e.getElementsByTagName("input"))&&i.length)for(t=0;t<i.length;t++)if(!i[t].disabled)switch(i[t].type.toLowerCase()){case"hidden":this.basketParams[i[t].name]=i[t].value,s=!0;break;case"radio":i[t].checked&&(this.basketParams[i[t].name]=i[t].value,s=!0)}}s||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}},enableAddToBasketLoading:function(){this.obAddToBasketBtn&&this.obAddToBasketBtn.classList.add("btn-loading","disabled")},disableAddToBasketLoading:function(){this.obAddToBasketBtn&&this.obAddToBasketBtn.classList.contains("btn-loading")&&this.obAddToBasketBtn.classList.remove("btn-loading","disabled")},sendToBasket:function(){if(this.canBuy)switch(this.productType){case 0:this.config.showQuantity?Basket.add(this.product.id,this.obQuantity.value):Basket.add(this.product.id,1),this.basketResult({STATUS:"OK"});break;case 1:case 2:case 3:this.enableAddToBasketLoading(),this.initBasketUrl(),this.fillBasketProps(),BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)})}},add2Basket:function(){this.basketMode="ADD",this.basket()},buyBasket:function(){this.basketMode="BUY",this.basket()},basket:function(){if(this.obBasketActions&&null!=t.Basket){var s=Basket.inbasket();switch(this.productType){case 3:if(BX.util.in_array(this.offers[this.offerNum].ID+"",s))return void this.basketRedirect();break;default:if(BX.util.in_array(this.product.id+"",s))return void this.basketRedirect()}}var e="";if(this.canBuy)switch(this.productType){case 1:case 2:this.basketData.useProps&&!this.basketData.emptyProps?(this.initPopupWindow(),this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS")),BX(this.visual.BASKET_PROP_DIV)&&(e=BX(this.visual.BASKET_PROP_DIV).innerHTML),this.obPopupWin.setContent(e),this.obPopupWin.setButtons([new i({text:BX.message("BTN_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]),this.obPopupWin.show()):this.sendToBasket();break;case 0:case 3:this.sendToBasket()}},basketResult:function(t){var s,e;this.disableAddToBasketLoading(),this.obPopupWin&&this.obPopupWin.close(),BX.type.isPlainObject(t)&&("OK"===t.STATUS&&this.setAnalyticsDataLayer("addToCart"),"OK"===t.STATUS&&"BUY"===this.basketMode?this.basketRedirect():"OK"===t.STATUS?(Basket.inbasket(3==this.productType?this.offers[this.offerNum].ID:this.product.id,!1),BX.onCustomEvent("OnBasketChange",[{},"ADD2CART"])):(this.initPopupWindow(),s='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(t.MESSAGE?t.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>",e=[new i({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})],this.obPopupWin.setTitleBar("OK"===t.STATUS?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR")),this.obPopupWin.setContent(s),this.obPopupWin.setButtons(e),this.obPopupWin.show()))},basketRedirect:function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},initPopupWindow:function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogElementBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:!0,contentColor:"white",className:this.config.templateTheme?"bx-"+this.config.templateTheme:""}))},incViewedCounter:function(){if(this.currentIsSet&&!this.updateViewedCount){switch(this.productType){case 1:case 2:this.viewedCounter.params.PRODUCT_ID=this.product.id,this.viewedCounter.params.PARENT_ID=this.product.id;break;case 3:this.viewedCounter.params.PARENT_ID=this.product.id,this.viewedCounter.params.PRODUCT_ID=this.offers[this.offerNum].ID;break;default:return}this.viewedCounter.params.SITE_ID=BX.message("SITE_ID"),this.updateViewedCount=!0,BX.ajax.post(this.viewedCounter.path,this.viewedCounter.params,BX.delegate(function(){this.updateViewedCount=!1},this))}},allowViewedCount:function(t){this.currentIsSet=!0,t&&this.incViewedCounter()},setOfferCurrentValue:function(t,i){var s=this.getEntities(t,"sku-current-value");for(var e in s)s.hasOwnProperty(e)&&BX.type.isDomNode(s[e])&&(s[e].innerHTML=i.getAttribute("title"))},setCartStatus:function(){if(this.obBasketActions&&null!=t.Basket){var i,s=Basket.inbasket();switch(this.productType){case 3:i=this.offers[this.offerNum].ID;break;default:i=this.product.id}BX.util.in_array(i,s)?(BX.addClass(this.obBasketActions,"is-incart"),this.obBuyBtn&&(this.obBuyBtn.innerHTML=this.mess.MESS_BTN_INCART),this.obAddToBasketBtn&&(this.obAddToBasketBtn.innerHTML=this.mess.MESS_BTN_INCART)):(BX.removeClass(this.obBasketActions,"is-incart"),this.obBuyBtn&&(this.obBuyBtn.innerHTML=this.mess.MESS_BTN_BUY),this.obAddToBasketBtn&&(this.obAddToBasketBtn.innerHTML=this.mess.MESS_BTN_ADD_TO_BASKET))}},favorite:function(t){BX.PreventDefault(t),RS.Favorite.request(this.product.id)},checkFavorite:function(){if(this.obFavorite){var t=this.obFavorite.querySelector('[data-entity="favorite-title"]');BX.util.in_array(this.product.id,RS.Favorite.getItems())?(BX.addClass(this.obFavorite,"checked"),t&&(t.innerHTML=BX.message("BTN_FAVORITE_DEL"))):(BX.removeClass(this.obFavorite,"checked"),t&&(t.innerHTML=BX.message("BTN_FAVORITE_ADD")))}},setTimer:function(t){var i=this.getEntity(this.obSaleBanner,"sale-banner-title");i&&(i.innerHTML=t.TITLE),RS.Init(["timers"],this.obSaleBanner,{DATE_FROM:t.DATE_FROM,DATE_TO:t.DATE_TO,AUTO_RENEWAL:t.AUTO_RENEWAL,QUANTITY:t.QUANTITY})},showSaleBanner:function(){this.obSaleBanner&&(this.obSaleBanner.style.display="")},hideSaleBanner:function(){this.obSaleBanner&&(this.obSaleBanner.style.display="none")},buy1Click:function(t){if(this.canBuy){var i,s=BX.proxy_context,e={};switch(BX.PreventDefault(t),this.productType){case 3:i=this.offers[this.offerNum].ID;break;default:i=this.product.id}this.config.showQuantity?e["QUANTITY_"+i]=this.obQuantity.value:"Q"===this.currentPriceMode?e["QUANTITY_"+i]=parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):e["QUANTITY_"+i]=this.stepQuantity,RS.Utils.popup({src:s.getAttribute("href"),type:"ajax",$orig:$(s),ajax:{settings:{type:"POST",data:{RS_ORDER_IDS:e}}}},"window")}}}}}(window);