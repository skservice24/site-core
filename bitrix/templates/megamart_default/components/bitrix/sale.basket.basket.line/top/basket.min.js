!function(t,s,e){"use strict";function a(){this.ajaxUrl="/bitrix/components/bitrix/sale.basket.basket/ajax.php",this.inBasketProducts=[]}e.RS||(e.RS={}),!e.RS.Basket&&t&&(a.prototype.inbasket=function(s,e){return e=e||!1,s&&(s=(s=$.isArray(s)?s:[s]).map(function(t){return parseInt(t,10)}),this.inBasketProducts=e?s:t.util.array_merge(this.inBasketProducts,s)),this.inBasketProducts},a.prototype.frombasket=function(s){this.inBasketProducts.forEach(function(e,a){e==s&&(this.inBasketProducts=t.util.deleteFromArray(this.inBasketProducts,a))}.bind(this))},a.prototype.add=function(s,e){var a={action:"add2basket"};return a.product_id=s,a.sessid=t.bitrix_sessid(),e&&(a.quantity=e),t.ajax.post(this.ajaxUrl,a,function(e){(e=t.parseJSON(e))&&(this.inbasket(s,!1),t.onCustomEvent("OnBasketChange"))}.bind(this))},a.prototype.updateQuantity=function(s,e){var a={action:"recalculate",sessid:t.bitrix_sessid(),site_id:t.message("SITE_ID"),props:{},action_var:"action",select_props:"QUANTITY",offers_props:"",quantity_float:"N",count_discount_4_all_quantity:"Y",price_vat_show_value:"Y",hideCoupon:"Y",use_prepayment:"N"};return a["QUANTITY_"+s]=e,t.ajax.post(this.ajaxUrl,a,function(s){(s=t.parseJSON(s))&&t.onCustomEvent("OnBasketChange",[s.BASKET_DATA])})},a.prototype.delete=function(s,e){var a={action:"recalculate",sessid:t.bitrix_sessid(),site_id:t.message("SITE_ID"),props:{},action_var:"action",select_props:"DELETE",offers_props:"",quantity_float:"N",count_discount_4_all_quantity:"Y",price_vat_show_value:"Y",hideCoupon:"Y",use_prepayment:"N"};return a["DELETE_"+s]="Y",t.ajax.post(this.ajaxUrl,a,function(s){(s=t.parseJSON(s))&&(this.frombasket(e),t.onCustomEvent("OnBasketChange",[s.BASKET_DATA]))}.bind(this))},a.prototype.clear=function(s){var e=new t.Promise,a={action:"recalculate",sessid:t.bitrix_sessid(),site_id:t.message("SITE_ID"),props:{},action_var:"action",select_props:"DELETE",offers_props:"",quantity_float:"N",count_discount_4_all_quantity:"Y",price_vat_show_value:"Y",hideCoupon:"Y",use_prepayment:"N"};return s.forEach(function(t){a["DELETE_"+t]="Y"}),t.ajax.post(this.ajaxUrl,a,function(s){(s=t.parseJSON(s))&&(this.inbasket([],!0),t.onCustomEvent("OnBasketChange",[s.BASKET_DATA]),e.resolve())}.bind(this)),e},e.Basket=new a)}(BX,document,window);