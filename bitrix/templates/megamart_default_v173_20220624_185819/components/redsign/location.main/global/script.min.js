BX.namespace("RS"),window.RSLocation||(window.RSLocation=function(){var t=function(t,i){this.data=t,this.params=i,this.confirmPopup=document.getElementById(i.confirmPopupId),this.confirmPopup&&this.isNeedShowConfirm()&&this.showConfirm()},i=function(t,i){return localStorage.setItem(t,i)};return BX.merge(t.prototype,{showConfirmPopup:function(){this.confirmPopup=document.getElementById(this.params.confirmPopupId),this.confirmPopup&&this.isNeedShowConfirm()&&this.showConfirm()},getCityId:function(){return this.data.ID},getCityName:function(){return this.data.NAME},isNeedShowConfirm:function(){return t="city_confirmed",!localStorage.getItem(t);var t},showConfirm:function(){this.confirmPopup.style.display="block",setTimeout(function(){var t=$(this.confirmPopup);t.hasClass("anim-start")&&t.removeClass("anim-start")}.bind(this),1e3)},hideConfirm:function(){this.confirmPopup.style.display="none",i("city_confirmed",!0)},change:function(t){var i={action:"change",id:t,siteId:this.params.siteId};return this.request(i).then(BX.proxy(this.changeSuccess,this))},changeSuccess:function(t){return this.data=t,i("city_confirmed",!0),BX.onCustomEvent("rs.location_change",[t]),t},request:function(t){var i=new BX.Promise;return t.sessid=BX.bitrix_sessid(),t.backurl=window.location.href,BX.ajax({url:this.params.ajaxUrl,method:"POST",data:t,dataType:"json",onsuccess:function(t){i.resolve(t)},onfailure:function(t){i.reject(t)}}),i}}),t}());